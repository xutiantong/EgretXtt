var pr;!function(t){var n=function(){function t(t,n,e){this.x=t||0,this.y=n||0,this.id=e}var n=(__define,t);n.prototype;return t}();t.Point=n,egret.registerClass(n,"pr.Point");var e=function(){function t(t,n,e){this.name=t,this.score=n,this.time=e}var n=(__define,t);n.prototype;return t}();t.Result=e,egret.registerClass(e,"pr.Result");var i=function(){function t(){this.Origin=new n(0,0,0),this.NumPoints=32,this.PointClouds=[]}var i=(__define,t),r=i.prototype;return t.create=function(){return new t},r.PointCloud=function(t,n){var e={};return e.Name=t,e.Points=this.Resample(n,this.NumPoints),e.Points=this.Scale(e.Points),e.Points=this.TranslateTo(e.Points,this.Origin),e},r.recognize=function(t){var n=Date.now();t=this.Resample(t,this.NumPoints),t=this.Scale(t),t=this.TranslateTo(t,this.Origin);for(var i=+(1/0),r=-1,o=0;o<this.PointClouds.length;o++){var s=this.GreedyCloudMatch(t,this.PointClouds[o]);i>s&&(i=s,r=o)}var a=Date.now();return-1==r?new e("No match.",0,a-n):new e(this.PointClouds[r].Name,Math.max((i-2)/-2,0),a-n)},r.addGesture=function(t,n){this.PointClouds[this.PointClouds.length]=this.PointCloud(t,n);for(var e=0,i=0;i<this.PointClouds.length;i++)this.PointClouds[i].Name==t&&e++;return e},r.deleteAllGestures=function(){this.PointClouds.length=0},r.getGesture=function(t){var n=[];if(!t)return this.PointClouds;for(var e=this.PointClouds.length,i=0;e>i;i++)this.PointClouds[i].Name==t&&n.push(this.PointClouds[i]);return n},r.GreedyCloudMatch=function(t,n){for(var e=.5,i=Math.floor(Math.pow(t.length,1-e)),r=+(1/0),o=0;o<t.length;o+=i){var s=this.CloudDistance(t,n.Points,o),a=this.CloudDistance(n.Points,t,o);r=Math.min(r,Math.min(s,a))}return r},r.CloudDistance=function(t,n,e){for(var i=new Array(t.length),r=0;r<t.length;r++)i[r]=!1;var o=0,s=e;do{for(var a=-1,h=+(1/0),l=0;l<i.length;l++)if(!i[l]){var u=this.Distance(t[s],n[l]);h>u&&(h=u,a=l)}i[a]=!0;var g=1-(s-e+t.length)%t.length/t.length;o+=g*h,s=(s+1)%t.length}while(s!=e);return o},r.Resample=function(t,e){for(var i=this.PathLength(t)/(e-1),r=0,o=new Array(t[0]),s=1;s<t.length;s++)if(t[s].id==t[s-1].id){var a=this.Distance(t[s-1],t[s]);if(r+a>=i){var h=t[s-1].x+(i-r)/a*(t[s].x-t[s-1].x),l=t[s-1].y+(i-r)/a*(t[s].y-t[s-1].y),u=new n(h,l,t[s].id);o[o.length]=u,t.splice(s,0,u),r=0}else r+=a}return o.length==e-1&&(o[o.length]=new n(t[t.length-1].x,t[t.length-1].y,t[t.length-1].id)),o},r.Scale=function(t){for(var e=+(1/0),i=-(1/0),r=+(1/0),o=-(1/0),s=0;s<t.length;s++)e=Math.min(e,t[s].x),r=Math.min(r,t[s].y),i=Math.max(i,t[s].x),o=Math.max(o,t[s].y);for(var a=Math.max(i-e,o-r),h=new Array,s=0;s<t.length;s++){var l=(t[s].x-e)/a,u=(t[s].y-r)/a;h[h.length]=new n(l,u,t[s].id)}return h},r.TranslateTo=function(t,e){for(var i=this.Centroid(t),r=[],o=0;o<t.length;o++){var s=t[o].x+e.x-i.x,a=t[o].y+e.y-i.y;r[r.length]=new n(s,a,t[o].id)}return r},r.Centroid=function(t){for(var e=0,i=0,r=0;r<t.length;r++)e+=t[r].x,i+=t[r].y;return e/=t.length,i/=t.length,new n(e,i,0)},r.PathLength=function(t){for(var n=0,e=1;e<t.length;e++)t[e].id==t[e-1].id&&(n+=this.Distance(t[e-1],t[e]));return n},r.Distance=function(t,n){var e=n.x-t.x,i=n.y-t.y;return parseFloat(Math.sqrt(e*e+i*i).toFixed(2))},t}();t.PDollarRecognizer=i,egret.registerClass(i,"pr.NDollarRecognizer")}(pr||(pr={}));